How to remove the background from a fingerprint image?
image-processing fingerprint
I have a fingerprint image taken from a sliding scanner. However the output does not have clean background. It looks like this:

I want to remove the background so that further processing will be more accurate. Something like this:

How to do that? What image processing technique (if any) can be used? Thank you.


To start, I'd increase the contrast to 100% to get a pure black and white image (not greyscale).

You might try an edge detection filter.  That would help remove the background noise, and might sharpen up the fingerprint features for the rest of the processing.
Canny edge detector might be a good one to try first.  There's even a free web implementations you can try and a public-domain Java implementation available.
EDIT:  Was curious how it would work, so I tried the web implementation on default settings -- not too bad.  It does seem to come up with a few "phantom" features in there, but overall it looks a bit easier to process.


You can check the frequency spectrum for the area around the pixels. The less high frequency components you have, the more likely it is that the pixel is part of the background.
The most sophisticated way to do that would be to run a FFT of a block of pixels and check the spectrum directly. Since finger prints have a distinct frequency spectra it should be easy to separate background from fingerprint that way. 
Using Wavelets could also be worth a try. That lets you split the image into sub-bands of the frequency of interest directly. Finding a good wavelet requires lot of practice though.
If you want a non-overkill solution it may be fine if you run a high-pass filter of the image and use it for a simple mask-finding pass. Here's a rough outline how that works:

normalize the image: darkest pixel becomes -1, lightest pixel becomes 1. You can also use -128 / 127 if you prefer to work with bytes.
run a gaussian blur over the image. Experiment with the radius.
subtract the normalized image from the blured image. Handle overflows by saturating to -1 and 1. The image will now roughly look like it was edge-detected, but with shades of gray instead of a binary mask.
Run a mask-pass over the image from step 3. The higher the absolute value of each pixel, the higher the chance that it is part of the fingerprint. You can generate a mask by choosing a good threshold value.
use the mask to prepare your source-image.

For completes sake you can also do it with image morphology:

Run a edge-detector on your image. Using the Canny detector is a good choice but a simple 3x3 edge-detector kernel would work as well.
Run multiple dilation passes on the edges. This will at each pass grow a border around all white pixels and make the edges thicker. Do this until all the area of the finger-print is covered with white pixels. In your example I think 4 or 5 passes are enough. 
You can now directly use the dilated image as a mask.

Link: Dilation http://homepages.inf.ed.ac.uk/rbf/HIPR2/dilate.htm

try some contrast enhancement (e.g. mexican hat) and after that some advanced enhancement.
we had good results when using Gabor-filter techniques to improve CT images of boles for dendrochronology. we used gabor filter because they are widely used withing fingeprint matching systems and our images were somewhat similar.
after that all you have to do is some (i'd suggest locally adaptive) tresholding, and you got your binary image.

There are many types of algorithms to do segmentation of fingerprints. One of them that works fine for sensors (your case) is based on the mean and variance of each pixel in the image. Below is the steps of the algorithm, that you can find here:
Fingerprint Segmentation: An Investigation of Various Techniques and a Parameter Study of a Variance-Based Method 
1. Load an image with size R x C pixels. Here the content inside the fingerprint does not matter, so I cover it. You can see the noise around the fingerprint (small points) and this is a good quality image take from sensor, may your image has a poor quality and more noise on the background.
2. I did not perform the normalization of the image as is in the paper. Therefore, the next step was defining pixels-blocks of size w x w and divided the image in non overlapping blocks.
3. For each pixel move the block and calculate the mean and variance. Save each variance in a matrix for further comparison. You will have to threat the borders.

4. Define a threshold. In the paper for a w = 15 the threshold is T = 210. 
5. For each variance compare with the threshold value, if it is smaller it will be background , if not , is the fingerprint itself.
After all this steps you will have an image with less noise on the background. Similar to this one: 
Here is the algorithm as it is in the paper: 
For others algorithms, see:
An Improved Fingerprint Segmentation Algorithm Based on Mean and Variance
Improved fingerprint image segmentation using new modified gradient based technique
