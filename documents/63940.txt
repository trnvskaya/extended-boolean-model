Missing classes in WMI when non-admin
vbscript wmi
I'd like to be able to see Win32_PhysicalMedia information when logged in as
a Limited User in Windows XP (no admin rights). It works ok when logged in as Admin,
WMIDiag has just given a clean bill of health, and Win32_DiskDrive class
produces information correctly, but Win32_PhysicalMedia produces a count of 0
for this code
set WMI = GetObject("WinMgtmts:/root/cimv2")
set objs = WMI.InstancesOf("Win32_PhysicalMedia")
wscript.echo objs.count

Alternatively, if the hard disk serial number as found on the SerialNumber
property of the physical drives is available in another class which I can
read as a limited user please let me know. I am not attempting to write to
any property with WMI, but I can't read this when running as a Limited User.
Interestingly, DiskDrive misses out the Signature property, which would do for
my application when run as a Limited User but is present when run from an
Admin account.


WMI does not give limited users this information.
If you can access Win32 functions from your language, you can call GetVolumeInformation.
