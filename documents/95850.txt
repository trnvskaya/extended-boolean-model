How to find Commit Charge programmatically?
c#
I'm looking for the total commit charge.


Here's an example using WMI:
strComputer = "."

Set objSWbemServices = GetObject("winmgmts:\\" & strComputer)
Set colSWbemObjectSet = _
 objSWbemServices.InstancesOf("Win32_LogicalMemoryConfiguration")

For Each objSWbemObject In colSWbemObjectSet
 Wscript.Echo "Total Physical Memory (kb): " & _
 objSWbemObject.TotalPhysicalMemory
 WScript.Echo "Total Virtual Memory (kb): " & _
 objSWbemObject.TotalVirtualMemory
 WScript.Echo "Total Page File Space (kb): " & _
 objSWbemObject.TotalPageFileSpace
Next

If you run this script under CScript, you should see the number of kilobytes of physical memory installed on the target computer displayed in the command window. The following is typical output from the script:
Total Physical Memory (kb): 261676
Edit: Included total page file size property also
taken from: http://www.microsoft.com/technet/scriptcenter/guide/sas_wmi_dieu.mspx?mfr=true

    public static long GetCommitCharge()
    {
        var p = new System.Diagnostics.PerformanceCounter("Memory", "Committed Bytes");
        return p.RawValue;
    }

