Is there a way to change something in Tool->Options via a macro?
visual-studio visual-studio-2008
I'd like to be able to toggle easily between two values for "maximum number of parallel project builds" in Visual Studio 2008 (in Tools->Options->Projects and Solutions->Build and Run). (When I'm planning on doing concurrent work I'd like to reduce it from 4 to 3.) I'm not too well versed in writing macros for the IDE. When I try recording a macro, and perform all the actions (open the dialog, change the setting, click OK), the only thing that gets recorded is this:
DTE.ExecuteCommand ("Tools.Options")

Is my goal unattainable?


It appears to be impossible, according to the MSDN page for Determining Names of Property Items in Tools Options Pages 
If it was possible, it would have been something like this:
Dim p = DTE.Properties("ProjectsAndSolutions","BuildAndRun")
p.Item("MaxNumParallelBuilds")


This appears to now be possible in VS2010.  I'm no VB programmer, but here's what I got to work:
Sub EditConcurrentBuilds()
    Dim p As EnvDTE.Properties = DTE.Properties("Environment", "ProjectsAndSolution")
    Dim item As EnvDTE.Property = p.Item("ConcurrentBuilds")
    Dim text As String = InputBox("Enter number of concurrent builds", "Concurrent Build Option")
    Dim v As Integer = Val(text)

    If (v > 0 And v < 5) Then
        item.Value = text
    End If
End Sub

In this case, 4 is the most processors I've got on my machine.
