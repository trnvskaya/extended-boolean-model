Create an encrypted ZIP file in Python
python zip
I'm creating an ZIP file with ZipFile in Python 2.5, it works ok so far:
import zipfile, os

locfile = "test.txt"
loczip = os.path.splitext (locfile)[0] + ".zip"
zip = zipfile.ZipFile (loczip, "w")
zip.write (locfile)
zip.close()

but I couldn't find how to encrypt the files in the ZIP file.
I could use system and call PKZIP -s, but I suppose there must be a more "Pythonic" way.  I'm looking for an open source solution.


You can use the Chilkat library.  It's commercial, but has a free evaluation and seems pretty nice.
Here's an example I got from here:
import chilkat

# Demonstrates how to create a WinZip-compatible 128-bit AES strong encrypted zip
zip = chilkat.CkZip()
zip.UnlockComponent("anything for 30-day trial")

zip.NewZip("strongEncrypted.zip")

# Set the Encryption property = 4, which indicates WinZip compatible AES encryption.
zip.put_Encryption(4)
# The key length can be 128, 192, or 256.
zip.put_EncryptKeyLength(128)
zip.SetPassword("secret")

zip.AppendFiles("exampleData/*",True)
zip.WriteZip()


I created a simple library to create a password encrypted zip file in python. - here
import pyminizip

compression_level = 5 # 1-9
pyminizip.compress("src.txt", "dst.zip", "password", compression_level)

The library requires zlib.
I have checked that the file can be extracted in WINDOWS/MAC.

The duplicate question http://stackoverflow.com/a/2366917/874188 recommends using 7z instead of zip.  My experience bears this out.
Copy/pasting the answer by @JFSebastian here too for completeness:
To create encrypted zip archive (named 'myarchive.zip') using open-source 7-Zip utility:
rc = subprocess.call(['7z', 'a', '-pP4$$W0rd', '-y', 'myarchive.zip'] + 
                     ['first_file.txt', 'second.file'])

To install 7-Zip, type:
$ sudo apt-get install p7zip-full

To unzip by hand (to demonstrate compatibility with zip utitity), type:
$ unzip myarchive.zip

And enter P4$$W0rd at the prompt.
Or the same in Python 2.6+:
>>> zipfile.ZipFile('myarchive.zip').extractall(pwd='P4$$W0rd')

