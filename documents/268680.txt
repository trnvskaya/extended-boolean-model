How can I monitor the active thread count of a process (jvm) on linux?
linux multithreading jvm monitor
I would like to monitor the number of threads used by a specific jvm process on linux.
Is there an easy way to get this information without impacting the performance of the jvm process.
More specifically I am interested in the number of threads per state.


JStack is quite inexpensive - one option would be to pipe the output through grep to find active threads and then pipe through wc -l.
More graphically is JConsole, which displays the thread count for a given process.

Newer JDK distributions ship with JConsole and VisualVM. Both are fantastic tools for getting the dirty details from a running Java process. If you have to do this programmatically, investigate JMX.

try
ps huH p <PID_OF_U_PROCESS> | wc -l

or htop

If you use:
ps uH p <PID_OF_U_PROCESS> | wc -l

You have to subtract 1 to the result, as one of the lines "wc" is counting is the headers of the "ps" command.

Each thread in a process creates a directory under /proc/<pid>/task. Count the number of directories, and you have the number of threads.

jvmtop can show the current jvm thread count beside other metrics.

Here is one command that displays the number of threads of a given process :
ps -L -o pid= -p <pid> | wc -l

Unlike the other ps based answers, there is here no need to substract 1 from its output as there is no ps header line thanks to the -o pid=option.

ps -eLf on the shell shall give you a list of all the threads and processes currently running on the system.
Or, you can run top command then hit 'H' to toggle thread listings.

cat /proc/<PROCESS_PID>/status | grep Threads


If you're interested in those threads which are really active -- as in doing something (not blocked, not timed_waiting, not reporting "thread running" but really waiting for a stream to give data) as opposed to sitting around idle but live -- then you might be interested in jstack-active.
This simple bash script runs jstack then filters out all the threads which by heuristics seem to be idling, showing you stack traces for those threads which are actually consuming CPU cycles.

VisualVM can show clear states of threads of a given JVM process


$ ps H p pid-id
H - Lists all the individual threads in a process
or
$cat /proc/pid-id/status
pid-id is the Process ID
eg.. (Truncated the below output)
root@abc:~# cat /proc/8443/status
Name:   abcdd
State:  S (sleeping)
Tgid:   8443
VmSwap:        0 kB
Threads:    4
SigQ:   0/256556
SigPnd: 0000000000000000


To get the number of threads for a given pid:
ps -o nlwp <pid>
To the get the sum of all threads running in the system:
ps -eo nlwp | tail -n +2 | awk '{ num_threads += $1 } END { print num_threads }'
