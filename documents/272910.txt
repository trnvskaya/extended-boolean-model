In Java when does a URL connection close?
java exception url connection
When does java let go of a connections to a URL? I don't see a close() method on either URL or URLConnection so does it free up the connection as soon as the request finishes? I'm mainly asking to see if I need to do any clean up in an exception handler.
try {
  URL url = new URL("http://foo.bar");
  URLConnection conn = url.openConnection();
  // use the connection
}
catch (Exception e) {
  // any clean up here?
}



It depends on the specific protocol specified in the protocol. Some maintain persistent connections, other close their connections when your call close in the input or outputstream given by the connection. But other than remembering to closing the streams you opened from the URLConnection, there is nothing else you can do.
From the javadoc for java.net.URLConnection

Invoking the close() methods on the
  InputStream or OutputStream of an
  URLConnection after a request may free
  network resources associated with this
  instance, unless particular protocol
  specifications specify different
  behaviours for it.


If you cast to an HttpURLConnection, there is a disconnect() method. If the connection is idle, it will probably disconnect immediately. No guarantees.

Standard template for closing connection would look like this.
try {
  URL url = new URL("http://foo.bar");
  URLConnection conn = url.openConnection();
  // use the connection
}
catch (Exception e) {
  // any clean up here? - NOPE!
}
finally {
    conn.close();
}

Closing connection should be handled no matter if you got exception or not - finally fits this exactly.
