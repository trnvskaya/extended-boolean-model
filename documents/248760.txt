VB6 Editor changing case of variable names!
ide vb6
I'm not much of a Visual Basic person, but I am tasked with maintaining an old VB6 app.  Whenever I check out a file, the editor will replace a bunch of the uppercase variable names with lowercase automatically.  How can I make this stop!?  I don't want to have to change them all back, and it's a pain to have these changes show up in SourceSafe "Differences" when I'm trying to locate the REAL differences.
It is changing it automatically in the definition, too:
Dim C as Control becomes Dim c as Control.  Dim X& becomes Dim x&.  But it doesn't do it all the time; for example, three lines down from Dim x&, there's a Dim Y&, uppercase, which it did not change.  Why's it do this to me?


It must be defined/declared in lower-case. Locate the declaration and fix it there. The IDE will always change the case to match the declaration.

DJ is spot on... VB always changes the case of variables to match the original declaration. It's a 'feature'.

Continuing from DJ's answer...
And it won't only change the case of variables in the same scope either.
It will change the case of all variables with the same name in your entire project. So even if they're declared in uppercase in one place, another module might have different variables using the same variable names in lowercase, causing all variables in your project to change to lowercase, depending on which of the declarations was loaded (?) or edited last.
So the reason your C and X variables are changing case, while the Y isn't, is probably because C and X are declared somewhere else in your project too, but in lowercase, while Y isn't.
There's another mention of it here, where they mostly seem concerned with such variable names conflicting when case is being used to differentiate local from global variables. They end up going for prefixes instead.
The only alternative I can think of is to use some other editor with VB6-highlighting capabilities to do your editing...

To get past the painful file diff experience, set the VSS option in the diff dialog to do case-insensitive comparisons.  That way you'll only see the "real" changes.

Enums are even worse. Getting the case wrong anywhere the enum is used changes the case of the definition.

Continuing from Mercator's excellent answer...
I'd recommend:

Check out all files (I assume you're using VSS for a VB6 app)
Do a rebuild of the entire project group
Recheck back into VSS

Now base you're the real differences rather than the 'auto' changes that VB6 has tried to apply.

Close all the VB projects, open the form file with a text editor, change the case of all the names then re-open the Project with VB IDE.

Prevent VB6 auto correct For enum values 
As my general rule I declare constants in UPPERCASE. Since enums are essentially constants I like to declare values for enums in UPPERCASE as well. I noticed the VB6 IDE also auto corrects these.
I found the IDE does not correct these values when using numbers and underscores '_' in the value names.
Example: 
Public Enum myEnum
  VALUE      'Will be corrected to: Value
  VALUE1     'Will not be corrected
  VALUE_     'Will not be corrected
End Enum   


I do not know if this works in general and if this extends to naming/auto correction of variable names. 

Since I always find this thread first looking for a solution to messed-up casing, here is one Simon D proposed in a related question:
If you just need to fix one variable's casing (e.g. you accidentally made a cOrrectCAse variable and now they are all over the place), you can correct this for good by adding
#If False Then
    Dim CorrectCase
#End If

to the beginning of your module. If you save the project and remove the statement later, the casing remains correct.
Using Excel VBA I often accidentally change all Range.Row to Range.row by carelessly dimming a row variable inside some function - with the help of Simon D's solution I can fix this now.
