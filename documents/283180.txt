Is there a way to put aspx files into a class library in Visual Studio 2008 .NET 3.5?
c# .net asp.net .net-3.5
I've got a lot of pages in my site, I'm trying to think of a nice way to separate these into areas that are a little more isolated than just simple directories under my base web project.  Is there a way to put my web forms into a separate class library?  If so, how is it done?
Thanks in advance.


At first thought, I don't think this is possible, due to the way ASPX is non-precompiled..
However, you can create classes that inherit from Page and place them into a DLL to re-use code-behind functionality. This can of course include control instantiate logic if required, but there is no designer to work with (if you need it).

The other difficulty with this approach is that you wouldn't really have access to controls created on the ASP.NET page directly without using FindControl.  
However, all is not lost.  Instead of using an ASP.NET Web Site, you can choose to use an ASP.NET Web Application Project.  This uses the ASP.NET 1.1 functionality which allows you to essentially precompile.

The caveat is that, while you'll have the controls precompiled into your classes, you won't actually have the content on your page stored in your DLL.
The alternative is to use the web site publishing wizard, which performs the automatic ASP.NET compilation before deployment.  This, however, renders a series of DLLs that is fairly unusable; what is generated doesn't really make a lot of sense to developers (you'd get classes such as ASP.my_homepage_aspx) which, while usable, would hinder your development efforts.

My question is, why do you want to do this?
If it's purely organisational then your "simple folders" should really be enough, so maybe you need to re-think your project structure.
If it is for compilation purposes, like it takes ages to recompile the site every time you change something, maybe you could split the site into multiple site project that each run as a subdomain of your main site.
These will then be recompiled separately.
If it's an organisational thing but related to management, in that you have loads of code and it's difficult to get around then maybe you should assess the way you are building the site. Would an N-Tier aproach or ASP.NET MVC provide better separation of your code?
What do you think?...

You could also implement a VirtualPathProvider. I've seen this done to serve files from a single zip, they could also pull from a DLL.
