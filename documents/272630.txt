How to move documents from SharePoint 2003 to SharePoint 2007 with versioning?
sharepoint sharepoint-2007 sharepoint-2003
I'm desperately searching for a tool allowing me to copy documents with their old versions from a SharePoint 2003 to a SharePoint 2007 site.
Do you know about any simple (and preferably free) tool which does this?


We recently did a migration from SPS 2003 to MOSS 2007, and I was trying to figure out how to do this. Sadly, there didn't seem to be a great way. What I ended up doing was using a back up of my SPS 2003 content database and a MOSS 2007 VM to do a database attach upgrade of the whole SPS 2003 portal. Then, I used the content migration commands (stsadm -o export, stsadm -o import) to move the lists with all of their versions to the "real" MOSS 2007 site collection. 
This page gave me the steps for doing the database migration.
There are also some nice commands you can potentially use for moving just a list here. For the record, the migration commands (e.g. gl-exportlist, gl-importlist) only work between two MOSS 2007 installations.
I definitely had to try it both with the stsadm extensions and the built-in commands a couple of times before the results were acceptable. The real key was doing the database migration to a VM to get everything into MOSS so I could use those tools.
I know this seems like a crazy amount of work, but it's the only way I found to get it done without dropping thousands of dollars for something like AvePoint's DocAve Migrators. And it really wasn't that bad.
One thing to watch out for is that, if you include user security when you do the export and import, you will get a lot of SharePoint groups and users added to your production site collection.

This may be too late for you, but I needed to migrate from a SharePoint 2003 site to a SharePoint 2007 site and keep not only versions, but also the file metadata from all of the document libraries. The official methods of migrating or upgrading failed, so I ended up writing a tool that must run on the destination SharePoint 2007 server, but can copy from the 2003 server all lists and document libraries with metadata and version intact. It's available with source at http://sourceforge.net/projects/splistcp so feel free to use and improve it.

the splistcp worked really well, but I was getting a time out error every once in a while when it was trying to move a file.  I was getting a time out message, then a message that file couldn't be found, then the program just quit. I downloaded the source code, found in MBSPListItemsMap.cs where the program was trying to get the file.
I added a finally block below the the catch code around line 620 to write to consule to telling me what the system is doing:
                         ` catch (Exception e)
                        {
                            Console.WriteLine(e.Message);
                            bDownloadError = true;
                        }
                        finally
                        {
                            if (bDownloadError)
                            {
                                Console.WriteLine("Error in downloading file: " + fileName);
                                Console.WriteLine("Moving to next file");
                            }

                        }
                        if (!bDownloadError)
                        {
                            if (Program.beVerbose)
                            {
                                Console.WriteLine("Attaching " + fileName);
                            }
                            byte[] fileContents = MBSPSiteMap.ByteArrayFromFilePath(downloadPath);
                            newItem.Attachments.Add(fileName, fileContents);
                            File.Delete(downloadPath);
                        } `

I also added some Console.WriteLine statements else where to let me know what the system is doing.  Otherwise the system just chuggs along and you don't have a very good indicator of what it is doing.
This program was a great help as I had to move 770 records with about 20 columns of information and several attachments.
THANKS MICHAEL!!!!
