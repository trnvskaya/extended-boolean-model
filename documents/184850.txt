How to get an error-code from a VB component into (serverside) JScript
javascript asp-classic
I have an plain-old asp web site that makes a call to a method in a dll written in VB 6. This method sets an error code in the VB Err Object if something goes wrong. Now I want to access that error code and description set in the Err object from a javascript (where I do the call to the dll method). First: is it possible? Second: if it is possible, how can I do that? Thanks in advance!
My first idea was:

Function MyFunc()
{
  var obj = Server.CreateObject(âMyDll.MyClassâ);

  try
  {
    obj.MyMethod();
  }
  catch(error)
  {
    // Here I want to get the error code and description from the VB Err object
  }
}


However, when I try this, the error I get is wrong. (I tried to make a test-app which receives the same error.)  I get an error-code which isn't the same in JavaScript as in VB.
Anyone know how this aught to be done?
/L


In your MyClass, add a property that holds the error info when an error event occurs, then you should be able to look at obj.MyErrorCode and find out what you need.
