How do you specify a port range for Java sockets?
java tcp sockets udp
In Java you can give the number zero as a single parameter for the Socket or DatagramSocket constructor. Java binds that Socket to a free port then. Is it possible to limit the port lookup to a specific range?
Thanks in advance,
Roland


Hrm, after reading the docs, I don't think you can. You can either bind to any port, then rebind if it is not acceptable, or repeatedly bind to a port in your range until you succeed. The second method is going to be most "efficient".
I am uneasy about this answer, because it is... inelegant, yet I really can't find anything else either :/

Binding the socket to any free port is (usually) a feature of the operating system's socket support; it's not specific to java. Solaris, for example, supports adjusting the ephemeral port range through the ndd command. But only root can adjust the range, and it affects the entire system, not just your program.
If the regular ephemeral binding behavior doesn't suit your needs, you'll probably have to write your own using Socket.bind().

You might glance at the java code that implements the function you are using.  Most of the java libraries are written in Java, so you might just see what you need in there.
Assuming @Kenster was right and it's a system operation, you may have to simply iterate over ports trying to bind to each one or test it.  Although it's a little painful, it shouldn't be more than a few lines of code.

Here's the code you need:
public static Socket getListeningSocket() {
	for ( int port = MIN_PORT ; port <= MAX_PORT ; port++ )
	{
		try {
			ServerSocket s = new ServerSocket( port );
			return s;      // no exception means port was available
		} catch (IOException e) {
			// try the next port
		}
	}
	return null;   // port not found, perhaps throw exception?
}

