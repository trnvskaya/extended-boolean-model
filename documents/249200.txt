What is the fastest webserver solution with the lowest memory footprint?
webserver
I need a webserver to serve up very simple POST/GET requests as JSON.  I don't need MVC, Rails, Django.   I need something that takes up very little memory, preferrably around 5K per reqeust. The webserver will talk to backend services like Scribe using Facebook Thrift.  Each http request will also access a SQLLite database, one for each user and user's data do not overlap.  It will serve up static html files as well as the json webservice.
I am considering the following:

Njinx with PHP,
Kepler from Lua,
rolling my own with libevent or libev perhaps calling out to Lua, or
MochiWeb.

Which of these options are best and what other options are out there?  I can use PHP, python, or Lua for basic scripting and even could do basic C.  I am leaning towards some sort of Erlang solution.


Lighttpd has an excellent footprint, to the extent that most of your memory will probably taken up by whatever language you choose to use (unless you go the C route, which is really not recommended).

There's an article on IBM developerWorks with a pretty extensive list of "lightweight" web servers:
Lightweight Web servers: http://www.ibm.com/developerworks/web/library/wa-ltwebserv/

I've had a good experience with nginx (http://nginx.net/), that said, when choosing a webserver, you should look closely at your requirements and make an informed decision as these things can be very application specific.
You'll notice that in this question that a lot of people recommend g-wan, Webmachine, etc... these are all things you should look at and benchmark to see if they are faster for your use case.
This is the kind of question that encourages cheerleading, there is no "right answer".

Since you mentioned Python, you might want to take a look at web.py, for a very simple way to listen on port 80 and map URLs to actions.
It'll also run via your favorite CGI if you want to pair with a standard webserver (i.e. behind Nginx/FastCGI) -- and I'll second the recs of Nginx for massive concurrency on static files. (They used it with Lighttpd at Reddit.)
thttpd is the other webserver I'd look at, especially if memory is extremely scarce, like on an embedded system.

Mochiweb is super lightweight, and handles a stupidly high load.

As one of the authors of Webmachine, I'm happy to help you out.  One reason I'm following up is that even though there's no JSON-related code in Webmachine, you might find it useful to know that we use it on a daily basis for processing many different JSON requests and responses.  It's simple, cleanly extensible, and performs reasonably well.
If you just wanted static delivery, then something like nginx or lighttpd would be an obvious way to go.  For a mix of static and dynamic requests and built-in good Web behavior, you may find Webmachine a good fit.
Check out the trivial example code at http://code.google.com/p/webmachine/wiki/ExampleResources and the recent posts on the blog at http://blog.therestfulway.com/
for more information.
It has worked out well for us; if you have questions feel free to drop me a line.

Cherokee webserver at www.cherokee-project.com

Take a look at klone at koanlogic.com site ... being targeted at embedded systems it's very small, and incidentally very fast too: http://john.freml.in/teepeedee2-vs-klone .
It can be scripted in C/C++ (ultra performant) or usual PHP/CGI (a lot less performant), depending on skills/taste ...

To measure the footprint, have a look at the executable size (don't forget shared libraries).
TrustLeap G-WAN (150 KB, no dependencies) offers Java, C/C++, Objective-C and D scripts.
According to these benchmarks, it also uses less memory and CPU resources than Nginx or Lighttpd while running faster:
http://www.gwan.ch/benchmark

If could code in C or C++, I think lighttz would be the fastest and uses the least memory. However, the reason why it is so is because it's using libev and it has absolutely nothing, no php support, no html support - nothing. All it provides is a call back function where u handle each http request. You're are gonna have to parse the http GET/POST request and return the html as a string. You can see it being benchmarked against nginx, lighttpd, apache etc and come up on top (link).

You could have a look at FAPWS (Fast Asynchronous Python WSGI server). The philosophy of the project match perfectly your needs. 
http://www.fapws.org

The fastest embedded web-server hands down is Snorkel - checkout there web site, they destroyed nginx in my testing using ab.  http://sites.google.com/site/snorkelembedded

G-WAN (150 KBÂ including ANSIÂ CÂ scripts)Â has a native JSONÂ parser, probably the fastest available given the features (it lets you search entries by name or by value in addition to import/export from/to text).
Beating the 150 KBÂ footprint (server + script engine included) will be difficult.

Take a look at this. I think that's exactly what the information you are looking for. You don't need a full featured web server, so using Erlang+libevent/libev should be good.

Nginx is compared to Varnish (the cache used by Facebook) and Apache Traffic Server (the cache used by Yahoo!):
And, Igor Sysoev, the guy behind Nginx, has not been short of comments on his blog.

For C or Lua, Mongoose is an option, https://github.com/valenok/mongoose .
It uses more than 5k per request, mostly because the per-connection data has a buffer for the request + headers preallocated, and maximum request size is set to 16k by default. This is tunable though, there is no problem to make it less than 5k, just change #define MAX_REQUEST_SIZE 16384 in mongoose.c when you embed Mongoose. In terms of footprint, it is around 50k compiled on disk not counting Lua (in case you need it) and SSL (also, in case you need it). Runtime footprint depends on OS.
