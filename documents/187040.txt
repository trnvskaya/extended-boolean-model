How do I return an exit code from a VBScript console application
vbscript
I Have an old vbs script file being kicked off by an AutoSys job. Can I, and how do I, return an int return value to indicate success or failure?


Try:
WScript.Quit n

Where n is the ERRORLEVEL you want to return

I found the answer :0)
 DIM returnValue
 returnValue = 99
 WScript.Quit(returnValue)

This seems to work well.

You can use Err.Number to get the error code.
objShell.Run "cmd.exe /c del C:\DeleteFile.txt"
If Err.Number <> 0 Then
    Wscript.echo "Failed to delete, error code: " & Err.Number
Else
    Wscript.echo "Delete successful"
End if

Or
Declare a variable to store the return code:
errorCode = objShell.Run ("cmd.exe /c del C:\DeleteFile.txt")
If errorCode  <> 0 Then
    Wscript.echo "Failed to delete, error code: " & errorCode 
Else
    Wscript.echo "Delete successful"
End if

The difference between these two method are Err.Number method can also get the error description, which like "Err.Description. And the variable storing only can get return code.
