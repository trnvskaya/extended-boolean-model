Provisioning Issue using CrmDeploymentService
deployment dynamics-crm-4
i've been working on Provision of an organization for quite a few days , and had faced  few issues which i was successful in resolving them.Let me explain abt the issues i faced, the MSCrmServices is a process that is running under the Network Service.
When I call the 'Execute' method on the service from a console application
all actions preformed run under the context of the 'Network Service' account.
The Network Service account has not enough rights to create an organization
so many problems occur during the action.

Registry access not allowed.
Not the correct SQL Server rights
Not enough AD rights.
...

Impersonation doesn't work, the service uses the process account to perform
the actions.  The only thing that works is to run the CRMAppPool identity as
an administrator which has the deployment administrator rights (added through
the Deployment manager tool).
 But this issues in CRM deployment doesnt seem to faceoff from me :(. now that i have a new issue after changing the Pool identity to the system administrator, the deployment service gives an error saying Unauthorized!!!! and further when i check the log it says..

Process: w3wp |Organization:00000000-0000-0000-0000-000000000000
  |Thread:    1 |Category: Exception |User:
  00000000-0000-0000-0000-000000000000 |Level: Error |
  CrmException..ctor
at CrmException..ctor(String message, Exception innerException, Int32
  errorCode, Boolean isFlowControlException, Boolean enableTrace)
at CrmException..ctor(String message, Int32 errorCode)
at CrmObjectNotFoundException..ctor(BusinessEntityMoniker moniker)
at
  BusinessProcessObject.DoRetrievePublishableSingle(BusinessEntityMoniker
  moniker, EntityExpression entityExpression, Boolean
  includeUnpublished, ExecutionContext context)
at BusinessProcessObject.RetrieveUnpublished(BusinessEntityMoniker
  moniker, EntityExpression entityExpression, ExecutionContext context)
at OrganizationUIService.RetrieveUnpublished(BusinessEntityMoniker
  moniker, EntityExpression entityExpression, ExecutionContext context)
at OrganizationUIService.RetrieveOldFormXml(BusinessEntityMoniker
  moniker, ExecutionContext context)
at OrganizationUIService.ExtractAndSaveFormLabels(IBusinessEntity
  entity, ExecutionContext context)
at OrganizationUIService.Create(IBusinessEntity entity,
  ExecutionContext context)
at ImportFormXmlHandler.createOrgUI(OrganizationUIService
  orgUIService, XmlNode formNode)
at ImportFormXmlHandler.ImportItem()
at ImportHandler.Import()
at ImportHandler.Import()
at RootImportHandler.RunImport()
at ImportXml.RunImport()
at NewOrgUtility.OrganizationImportDefaultData(Guid organizationId,
  Version existingDatabaseVersion, String importFile)
at NewOrgUtility.OrganizationImportDefaultData(Guid organizationId,
  String importFile)
at NewOrgUtility.ConfigureOrganization(String organizationId, String
  organizationName, String userAccountName, String userFirstName, String
  userLastName, String userEmail, String languageCode, String
  privilegedUserGroup, String sqlAccessGroup, String userGroup, String
  reportingGroup, String privilegedReportingGroup, Boolean
  grantNetworkServiceAccess, Boolean autoGroupManagement, String
  importFileLocation, Boolean sqmOption)
at CreateOrganizationInstaller.Create(Guid organizationId, String
  organizationUniqueName, String organizationFriendlyName, String
  baseCurrencyCode, String baseCurrencyName, String baseCurrencySymbol,
  String initialUserDomainName, String initialUserFirstName, String
  initialUserLastName, String sqlServerName, Uri reportServerUrl, String
  privilegedUserGroupName, String sqlAccessGroupName, String
  userGroupName, String reportingGroupName, String
  privilegedReportingGroupName, String applicationPath, String
  languageId, Boolean sqmOption, String organizationCollation,
  MultipleTenancy multipleTenancy)
at CreateOrganizationInstaller.Create(ICreateOrganizationInfo
  organizationInfo)
at OrganizationService.Create(DeploymentEntity entity)
at CreateRequest.Process()
at CrmDeploymentService.Execute(DeploymentServiceRequest request)
at RuntimeMethodHandle._InvokeMethodFast(Object target, Object[]
  arguments, SignatureStruct& sig, MethodAttributes methodAttributes,
  RuntimeTypeHandle typeOwner)
at RuntimeMethodHandle.InvokeMethodFast(Object target, Object[]
  arguments, Signature sig, MethodAttributes methodAttributes,
  RuntimeTypeHandle typeOwner)
at RuntimeMethodInfo.Invoke(Object obj, BindingFlags invokeAttr,
  Binder binder, Object[] parameters, CultureInfo culture, Boolean
  skipVisibilityChecks)
at RuntimeMethodInfo.Invoke(Object obj, BindingFlags invokeAttr,
  Binder binder, Object[] parameters, CultureInfo culture)
at LogicalMethodInfo.Invoke(Object target, Object[] values)
at WebServiceHandler.Invoke()
at WebServiceHandler.CoreProcessRequest()
at SyncSessionlessHandler.ProcessRequest(HttpContext context)
at
  CallHandlerExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute()
at HttpApplication.ExecuteStep(IExecutionStep step, Boolean&
  completedSynchronously)
at ApplicationStepManager.ResumeSteps(Exception error)
at
  HttpApplication.System.Web.IHttpAsyncHandler.BeginProcessRequest(HttpContext
  context, AsyncCallback cb, Object extraData)
at HttpRuntime.ProcessRequestInternal(HttpWorkerRequest wr)
at HttpRuntime.ProcessRequestNoDemand(HttpWorkerRequest wr)
at ISAPIRuntime.ProcessRequest(IntPtr ecb, Int32 iWRType)

Any idea on this.?
Have anyone of you come across such an issue. I've been trying to resolve this issue but hard luck.


Edit:  Actually you're not alone.
http://www.eggheadcafe.com/software/aspnet/31450420/crmdeploymentservice-crm.aspx
Hope that helps.
