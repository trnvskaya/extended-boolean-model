XPath and Selecting a single node
.net xpath
I'm using XPath in .NET to parse an XML document, along the lines of:
XmlNodeList lotsOStuff = doc.SelectNodes("//stuff");

foreach (XmlNode stuff in lotsOStuff)
{
   XmlNode stuffChild = stuff.SelectSingleNode("//stuffChild");
   // ... etc
}

The issue is that the XPath Query for stuffChild is always returning the child of the first stuff element, never the rest. Can XPath not be used to query against an individual XMLElement?


// at the beginning of an XPath expression starts from the document root.  Try ".//stuffChild".  . is shorthand for self::node(), which will set the context for the search, and // is shorthand for the descendant axis.
So you have:
XmlNode stuffChild = stuff.SelectSingleNode(".//stuffChild");

which translates to:
xmlNode stuffChild = stuff.SelectSingleNode("self::node()/descendant::stuffChild");
xmlNode stuffChild = stuff.SelectSingleNode("self::node()/descendant-or-self::stuffChild");

In the case where the child node could have the same name as the parent, you would want to use the slightly more verbose syntax that follows, to ensure that you don't re-select the parent:
xmlNode stuffChild = stuff.SelectSingleNode("self::node()/descendant::stuffChild");

Also note that if "stuffChild" is a direct descendant of "stuff", you can completely omit the prefixes, and just select "stuffChild".
XmlNode stuffChild = stuff.SelectSingleNode("stuffChild");

The W3Schools tutorial has helpful info in an easy to digest format.

The // you use in front of stuffChild means you're looking for stuffChild elements, starting from the root.
If you want to start from the current node (decendants of the current node), you should use .//, as in:
stuff.SelectSingleNode(".//stuffChild");


If "stuffChild" is a child node of "stuff", then your xpath should just be:
XmlNode stuffChild = stuff.SelectSingleNode("stuffChild");


Selecting single node means you need only the first element. So, the best solution is:
XmlNode stuffChild = stuff.SelectSingleNode("descendant::stuffChild[1]");

