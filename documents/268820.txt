Accessing a ColdFusion datasource from Java code
java servlets jdbc coldfusion
I have a servlet that I would like to run within ColdFusion MX 7. I would like to make use of an existing ColdFusion DSN as a javax.sql.DataSource, if possible.
I thought something like 
coldfusion.server.ServiceFactory.getDataSourceService().getDatasource(dsname);

would work, but unfortunately the servlet returns
java.lang.NoClassDefFoundError: coldfusion/server/ServiceFactory



That code will work fine, you just don't have ServiceFactory in your classpath. Ie, Java can't load that class. Try including a dependency on cfusion.jar from C:\CFusionMX7\lib.

It seems the simplest way to do this is to add an additional JNDI datasource into jrun-resources.xml. This can then be accessed in the conventional way:
Context context = new InitialContext();
DataSource ds = (DataSource)context.lookup("mydatasource");

It does mean duplicating database connection configuration, but I would rather do this than work with the largely undocumented coldfusion.server.* classes. 
