Access parent property in jQuery callback
javascript jquery
Unsure if I've phrased this correctly, but in the callback how do I reference the controls property of the base class?
This has been bugging me for some time and I usually work around it, but I'd be grateful if anybody can enlighten me on how I should do this properly.
var base = function() {
    var controls = {};

    return {
    	init: function(c) {
    		this.controls = c
    	},
    	foo: function(args) {
    		this.init(args.controls);
    		$(this.controls.DropDown).change(function() {
    			$(this.controls.PlaceHolder).toggle();
    		});
    	}
    }
};

Much Obliged,
Paul


You need to leverage closures here.
var base = function() {
var controls = {};

return {
    init: function(c) {
            this.controls = c
    },
    foo: function(args) {
            this.init(args.controls);
            $(this.controls.DropDown).change(function(controls) {
                    return function(){
                        $(controls.PlaceHolder).toggle();
                    }
            }(this.controls));
    }
}

};

Use the power of closures:
var base = function() {
    var controls = {};

    return {
        init: function(c) {
                this.controls = c
        },
        foo: function(args) {
                var self = this;

                this.init(args.controls);
                $(this.controls.DropDown).change(function() {
                        $(self.controls.PlaceHolder).toggle();
                });
        }
    }
};


Although closures are preferred, you could also use jquery bind to pass an object along:
var base = function() {
    var controls = {};

    return {
        init: function(c) {
            this.controls = c
        },
        foo: function(args) {
    		this.init(args.controls);
    		$(this.controls.DropDown).bind('change', {controls: this.controls}, function(event) {
    			$(event.data.controls.PlaceHolder).toggle();
    		});
        }
    }
};

