Best way to secure an AJAX app
ajax security ssl cookies
I am currently working on the authentication of an AJAX based site, and was wondering if anybody had any reccomendations on best practices for this sort of thing.
My original approach was a cookie based system.  Essentially I set a cookie with an auth code, and every data access changed the cookie.  As well, whenever there was a failed authentication, all sessions by that user were de-authenticated, to keep hijackers out.  To hijack a session, somebody would have to leave themselves logged in, and a hacker would need to have the very last cookie update sent to spoof a session.
Unfortunatley, due to the nature of AJAX, when making multiple requests quickly, they might come back out of order, setting the cookie wrong, and breaking the session, so I need to reimplement.
My ideas were: 

A decidedly less secure session based method
using SSL over the whole site (seems like overkill)
Using an iFrame which is ssl authenticated to do secure transactions (I just sorta assume this is possible, with a little bit of jquery hacking)

The issue is not the data being transferred, the only concern is that somebody might get control over an account that is not theirs.
A decidedly less secure session based method


What if you put a "generated" timestamp on each of the responses from the server and the AJAX application could always use the cookie with the latest timestamp.

Personally, I have not found using SSL for the entire site (or most of it) to be overkill.  Maybe a while ago when speeds and feeds were slower.  Now I wouldn't hesitate to put any part of a site under SSL.

If you've decided that using SSL for the entire site is acceptable, you might consider just using the old "Basic Authentication" where the server returns the 401 response which causes the browser to prompt for username/password.  If your application can live with this type of login, is works great for AJAX and all other accesses to your site because the browser handles re-submitting requests with appropriate credentials (and it is safe if you use SSL, but only if you use SSL -- don't use Basic auth with plain http!).

Your best bet is using an SSL connection over a previously authenticated connection with something Apache and/or Tomcat.  Form based authentication in either one, with a required SSL connection gives you a secure connection.  The webapp can then provide security and identity for the session and the client side Ajax doesn't need to be concerned with security.

SSL is a must, preventing transparent proxy connections that could be used by several users. Then I'd simply check the incoming ip address with the one that got authenticated.
Re-authenticate:

as soon as the ip address changes
on a time out bigger than n seconds without any request
individually on any important transaction


You might try reading the book Ajax Security,by Billy Hoffman and Bryan Sullivan. I found it changed my way of thinking about security. There are very specific suggestions for each phase of Ajax.

A common solution is to hash the user's session id and pass that in with every request to ensure the request is coming from a valid user (see this slideshow).  This is reasonably secure from a CSRF perspective, but if someone was sniffing the data it could be intercepted.  Depending on your needs, ssl is always going to be the most secure method.
